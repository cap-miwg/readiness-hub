<script type="text/babel">
// ES Qualification Card Component
// Displays a single ES qualification with name, functional area, status badge, and dates
const ESQualificationCard = ({
  qualification,
  onClick = null,
  showSkillsEvaluator = true,
  ES_FUNCTIONAL_AREAS
}) => {
  const isClickable = typeof onClick === 'function';

  return (
    <div
      className={`p-3 bg-slate-50 rounded-lg border border-slate-200 ${
        isClickable ? 'hover:border-blue-300 transition-colors cursor-pointer' : ''
      }`}
      onClick={isClickable ? () => onClick(qualification) : undefined}
    >
      <div className="flex items-start justify-between gap-2">
        <div className="flex-1">
          <div className="font-semibold text-sm text-slate-800 flex items-center gap-2">
            {showSkillsEvaluator && qualification.isSkillsEvaluator && (
              <Icon name="Star" className="w-4 h-4 text-amber-500 fill-current" />
            )}
            {qualification.name}
          </div>
          {qualification.functionalArea && (
            <div className="text-xs text-slate-500 mt-0.5">
              {ES_FUNCTIONAL_AREAS[qualification.functionalArea] || qualification.functionalArea}
            </div>
          )}
        </div>
        <ESBadge
          qualification={qualification}
          size="small"
          showStatus={true}
          onClick={(e) => e?.stopPropagation()}
        />
      </div>
      <div className="mt-2 text-xs text-slate-600 space-y-1">
        {qualification.completed && qualification.completed !== '01/01/1900' && (
          <div>Completed: {qualification.completed}</div>
        )}
        {qualification.expiration && qualification.expiration !== '01/01/1900' && (
          <div>Expires: {qualification.expiration}</div>
        )}
        {showSkillsEvaluator && qualification.isSkillsEvaluator && (
          <div className="text-amber-700 font-medium flex items-center gap-1 mt-1">
            <Icon name="Star" className="w-3 h-3" />
            Skills Evaluator Qualified
          </div>
        )}
      </div>
    </div>
  );
};

// ES Qualifications Section Component
// Displays the full ES qualifications section with header, optional skill tree button, and grid of cards
const ESQualificationsSection = ({
  qualifications = [],
  onQualificationClick = null,
  onViewSkillTree = null,
  showSkillTreeButton = true,
  showSkillsEvaluator = true,
  emptyMessage = "No emergency services qualifications on record",
  ES_FUNCTIONAL_AREAS,
  headerClassName = "flex items-center justify-between mb-2"
}) => {
  const hasQualifications = qualifications && qualifications.length > 0;
  const showTreeButton = showSkillTreeButton && hasQualifications && typeof onViewSkillTree === 'function';

  return (
    <div>
      <div className={headerClassName}>
        <h4 className="font-bold flex items-center gap-2">
          <Icon name="Activity" className="w-4 h-4 text-rose-600" />
          Emergency Services Qualifications
        </h4>
        {showTreeButton && (
          <button
            onClick={onViewSkillTree}
            className="text-xs px-3 py-1 bg-blue-50 text-blue-700 rounded-lg border border-blue-200 hover:bg-blue-100 transition-colors font-medium"
          >
            View Skill Tree
          </button>
        )}
      </div>
      {hasQualifications ? (
        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
          {qualifications.map((qual, i) => (
            <ESQualificationCard
              key={i}
              qualification={qual}
              onClick={onQualificationClick}
              showSkillsEvaluator={showSkillsEvaluator}
              ES_FUNCTIONAL_AREAS={ES_FUNCTIONAL_AREAS}
            />
          ))}
        </div>
      ) : (
        <div className="text-sm text-slate-400 italic bg-slate-50 border border-slate-100 rounded-lg p-3">
          {emptyMessage}
        </div>
      )}
    </div>
  );
};

// Compact ES Qualifications List Component (optional - for dashboard summary views)
// Displays ES qualifications in a more compact list format
const ESQualificationsList = ({
  qualifications = [],
  onQualificationClick = null,
  maxDisplay = null,
  showViewAll = false,
  onViewAll = null,
  ES_FUNCTIONAL_AREAS
}) => {
  const hasQualifications = qualifications && qualifications.length > 0;
  const displayQualifications = maxDisplay ? qualifications.slice(0, maxDisplay) : qualifications;
  const hasMore = maxDisplay && qualifications.length > maxDisplay;

  if (!hasQualifications) {
    return (
      <div className="text-xs text-slate-400 italic">
        No ES qualifications
      </div>
    );
  }

  return (
    <div className="space-y-2">
      {displayQualifications.map((qual, i) => (
        <div
          key={i}
          className={`flex items-center justify-between gap-2 p-2 rounded ${
            onQualificationClick ? 'hover:bg-slate-50 cursor-pointer' : ''
          }`}
          onClick={onQualificationClick ? () => onQualificationClick(qual) : undefined}
        >
          <div className="flex-1 min-w-0">
            <div className="text-sm font-medium text-slate-700 truncate flex items-center gap-1">
              {qual.isSkillsEvaluator && (
                <Icon name="Star" className="w-3 h-3 text-amber-500 fill-current flex-shrink-0" />
              )}
              {qual.name}
            </div>
            {qual.functionalArea && (
              <div className="text-xs text-slate-500 truncate">
                {ES_FUNCTIONAL_AREAS[qual.functionalArea] || qual.functionalArea}
              </div>
            )}
          </div>
          <ESBadge qualification={qual} size="small" />
        </div>
      ))}
      {hasMore && showViewAll && onViewAll && (
        <button
          onClick={onViewAll}
          className="text-xs text-blue-600 hover:text-blue-700 font-medium"
        >
          View all {qualifications.length} qualifications â†’
        </button>
      )}
    </div>
  );
};
</script>
